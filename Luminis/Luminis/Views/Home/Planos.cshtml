@model IEnumerable<Luminis.Models.Plano>
@{
    ViewData["Title"] = "Nossos Planos";
    string adminWhatsApp = ViewData["AdminWhatsApp"] as string ?? "5500000000000"; // Usa um número de fallback caso o valor seja nulo
}

<style>
    .btn-whatsapp-custom {
        background-color: #25D366 !important;
        border-color: #25D366 !important;
        color: white !important;
        font-weight: bold;
        transition: background-color 0.3s, border-color 0.3s;
    }

        .btn-whatsapp-custom:hover {
            background-color: #128C7E !important;
            border-color: #128C7E !important;
            color: white !important;
        }

    .card-destaque {
        border: 3px solid var(--luminis-blue-dark);
    }

    .card-header-destaque {
        background-color: var(--luminis-blue-dark);
    }
</style>

<div class="container my-5">
    <h1 class="text-primary fw-bold text-center mb-4">Conheça Nossos Planos para Psicólogos</h1>
    <p class="lead text-center">Junte-se à comunidade Luminis e expanda seu alcance profissional.</p>

    <div class="row justify-content-center mt-5">

        @if (Model != null && Model.Any())
        {
            @foreach (var plano in Model)
            {
                string cardClasses = plano.Destaque ? "shadow-lg card-destaque" : "shadow-sm";

                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 @cardClasses">

                        @if (plano.Destaque)
                        {
                            <div class="card-header text-white text-center fw-bold card-header-destaque">
                                <h4 class="mb-0">Mais Popular!</h4>
                            </div>
                        }

                        <div class="card-body text-center d-flex flex-column justify-content-between">
                            <div>
                                <h3 class="card-title text-primary">@plano.Nome</h3>
                                <p class="card-text text-muted">@plano.Descricao</p>

                                <ul class="list-unstyled text-start mx-auto mt-4" style="max-width: 250px;">
                                    @if (!string.IsNullOrEmpty(plano.Recursos))
                                    {
                                        @foreach (var recurso in plano.Recursos.Split(';'))
                                        {
                                            <li><i class="bi bi-check-circle-fill text-success"></i> @recurso</li>
                                        }
                                    }
                                </ul>

                                <h4 class="card-subtitle mb-2 text-muted mt-4">R$ @plano.Preco.ToString("F2") / @plano.Periodo</h4>
                                <p class="card-text text-sm">Pagamento via PIX direto com o administrador.</p>
                            </div>

                            <div class="d-grid gap-2 mt-3">
                                @{
                                    string msgWhatsApp = $"Olá! Tenho interesse no {plano.Nome} da Luminis. Poderia me ajudar com o pagamento?";
                                    string linkWhatsApp = $"https://wa.me/{adminWhatsApp}?text={Uri.EscapeDataString(msgWhatsApp)}";
                                }
                                <a href="@linkWhatsApp" target="_blank" class="btn btn-outline-primary btn-lg">
                                    <i class="bi bi-whatsapp"></i> Falar com Administrador
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="alert alert-info text-center" role="alert">
                Nenhum plano cadastrado no momento.
            </div>
        }

    </div>

    <div class="text-center mt-5">
        <p>Interessou-se por nossos planos? Escolha um deles e faça seu cadastro agora.</p>
        <a asp-controller="Account" asp-action="Register" class="btn btn-primary btn-lg">Cadastre-se Agora!</a>
    </div>

    <div class="text-center mt-4">
        <a asp-controller="Home" asp-action="Index" class="text-muted text-decoration-underline">
            <i class="bi bi-arrow-left"></i> Voltar para a Home
        </a>
    </div>
</div>